(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4794c912"],{"0a0d":function(e,t,r){e.exports=r("e829")},"2f37":function(e,t,r){var n=r("63b6");n(n.S,"Date",{now:function(){return(new Date).getTime()}})},"47d5":function(e,t,r){"use strict";r.d(t,"g",function(){return a}),r.d(t,"a",function(){return o}),r.d(t,"e",function(){return l}),r.d(t,"d",function(){return u}),r.d(t,"c",function(){return c}),r.d(t,"j",function(){return m}),r.d(t,"b",function(){return p}),r.d(t,"k",function(){return d}),r.d(t,"i",function(){return f}),r.d(t,"h",function(){return h}),r.d(t,"f",function(){return v});r("96cf");var n=r("3b8d"),i=(r("cadf"),r("551c"),r("097d"),r("c1fb")),s=r("b1ef"),a=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/getVisitorAllByVisitorName"),{pageNum:t,pageSize:r,query:{visitorName:n}}));case 1:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/addApply"),t));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),l=function(e){return i["a"].postFileData("".concat(s["a"],"/user/SanyBasicShrUser/fileUploadForVisitors"),e)},u=function(e){return i["a"].post("".concat(s["a"],"/user/SanyBasicShrUser/fileUploadForOutEmployersPhoto"),{imgStr:e})},c=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/confirmVisit"),{visitorId:t,source:r}));case 1:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/invalid"),{visitorId:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/cancel"),{visitorId:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/manualEnd"),{visitorId:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,r,n,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/getVisitorHistory"),{pageNum:t,pageSize:r,query:{startTime:n,endTime:a}}));case 1:case"end":return e.stop()}},e,this)}));return function(t,r,n,i){return e.apply(this,arguments)}}(),h=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/getVisitorDetails"),{visitorId:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i["a"].post("".concat(s["a"],"/visitorcontrol/SanyBussVisitor/getNamesByLike"),{queryStr:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},"5c41":function(e,t,r){"use strict";var n=r("7bb1"),i=r.n(n);i.a},"7bb1":function(e,t,r){},"7f7f":function(e,t,r){var n=r("86cc").f,i=Function.prototype,s=/^\s*function ([^ (]*)/,a="name";a in i||r("9e1e")&&n(i,a,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(e){return""}}})},"9a38":function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});r("cadf"),r("551c"),r("097d");var n=function(e,t){console.log("tel:",e),11===e.length?/^1[3456789]\d{9}$/.test(e)||t.$message({type:"error",message:"手机号码格式错误，请重新输入"}):t.$message({type:"error",message:"请输入11位手机号码"})};function i(e,t){15===e.length?/(^\d{15}$)/.test(e)||t.$message({type:"error",message:"身份证号码格式错误，请重新输入"}):18===e.length?/(^\d{17}([0-9]|x|X)$)/.test(e)||t.$message({type:"error",message:"身份证号码格式错误，请重新输入"}):t.$message({type:"error",message:"请输入15位或18位身份证号码"})}},c72d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("el-form",{ref:"tempVisitInputID",staticClass:"marginTop20 common-form-inline tempVisitInput_form",staticStyle:{position:"relative"},attrs:{inline:!0,model:e.formInline.sanyBussVisitor,rules:e.rules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"被拜访人"}},[r("el-input",{nativeOn:{keyup:function(t){return e.querySearch(t)}},model:{value:e.formInline.sanyBussVisitor.employerName,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"employerName",t)},expression:"formInline.sanyBussVisitor.employerName"}}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.employerNameSelectShow,expression:"employerNameSelectShow"}],staticClass:"tempVisitInput_employerName"},[r("el-scrollbar",{staticStyle:{height:"100%"}},[r("ul",{directives:[{name:"show",rawName:"v-show",value:e.restaurantsArr.length>0,expression:"restaurantsArr.length>0"}]},e._l(e.restaurantsArr,function(t,n){return r("li",{key:n,staticStyle:{cursor:"pointer"},on:{click:function(r){e.handleSelect(t)}}},[e._v("\n               "+e._s(t.name)+"\n             ")])}),0),r("div",{directives:[{name:"show",rawName:"v-show",value:e.restaurantsArr.length<=0,expression:"restaurantsArr.length<=0"}]},[e._v("暂无数据")])])],1)],1),r("el-form-item",{attrs:{label:"开始时间",prop:"planBeginTime"}},[r("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-value":new Date,"picker-options":e.pickerOptionsStart,placeholder:"选择日期时间"},model:{value:e.formInline.sanyBussVisitor.planBeginTime,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"planBeginTime",t)},expression:"formInline.sanyBussVisitor.planBeginTime"}})],1),r("el-form-item",{attrs:{label:"结束时间",prop:"planEndTime"}},[r("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-value":new Date,"picker-options":e.pickerOptionsEnd,placeholder:"选择日期时间"},model:{value:e.formInline.sanyBussVisitor.planEndTime,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"planEndTime",t)},expression:"formInline.sanyBussVisitor.planEndTime"}})],1),r("el-form-item",{attrs:{label:"来访人数量"}},[r("el-input-number",{attrs:{controls:!0,min:1},on:{change:e.handleInputPersonNum},model:{value:e.formInline.sanyBussVisitor.vistorNum,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"vistorNum",t)},expression:"formInline.sanyBussVisitor.vistorNum"}})],1),r("el-form-item",{attrs:{label:"是否驾车"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formInline.sanyBussVisitor.isCar,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"isCar",t)},expression:"formInline.sanyBussVisitor.isCar"}},e._l(e.isDriveCarOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"1"===e.formInline.sanyBussVisitor.isCar,expression:"formInline.sanyBussVisitor.isCar==='1'"}],attrs:{label:"驾车数量"}},[r("el-input-number",{attrs:{controls:!0,min:1},on:{change:e.handleInputCarNum},model:{value:e.formInline.sanyBussVisitor.carNum,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"carNum",t)},expression:"formInline.sanyBussVisitor.carNum"}})],1),r("el-form-item",{attrs:{label:"拜访原因"}},[r("el-input",{staticStyle:{width:"1285px"},attrs:{type:"textarea",rows:4,placeholder:"请输入原因"},model:{value:e.formInline.sanyBussVisitor.reason,callback:function(t){e.$set(e.formInline.sanyBussVisitor,"reason",t)},expression:"formInline.sanyBussVisitor.reason"}})],1)],1),r("div",{staticClass:"tempVisitInput_table tempVisitInput_personTable"},[r("table",[e._m(0),r("tbody",e._l(e.formInline.sanyBussVisitorDetailsList,function(t,n){return r("tr",{key:n},[r("td",{domProps:{textContent:e._s(n+1)}},[e._v("1")]),r("td",{staticStyle:{position:"relative"}},[r("el-input",{class:{regIsNull:e.regIsName},attrs:{placeholder:"请输入姓名"},on:{blur:function(r){e.blurUserName(t.visitorName)},change:function(r){e.inputChangeName(t.visitorName)}},model:{value:t.visitorName,callback:function(r){e.$set(t,"visitorName",r)},expression:"item.visitorName"}}),r("span",{staticStyle:{position:"absolute",top:"22px",left:"0px",color:"#f56c6c"}},[e._v("*")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowUserName,expression:"isShowUserName"}],staticStyle:{color:"#F56C6C","text-align":"left",position:"absolute",top:"50px",left:"8px"}},[e._v("请输入姓名")])],1),r("td",{staticStyle:{position:"relative"}},[r("el-input",{class:{regIsNull:e.regIsNull},attrs:{placeholder:"请输入电话"},on:{blur:function(r){e.blurPhone(t.phone)},change:function(r){e.regTel(t.phone)}},model:{value:t.phone,callback:function(r){e.$set(t,"phone",r)},expression:"item.phone"}}),r("span",{staticStyle:{position:"absolute",top:"22px",left:"0px",color:"#f56c6c"}},[e._v("*")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowPhone,expression:"isShowPhone"}],staticStyle:{color:"#F56C6C","text-align":"left",position:"absolute",top:"50px",left:"8px"}},[e._v("请输入电话")])],1),r("td",{staticStyle:{position:"relative"}},[r("el-input",{class:{regIsNull:e.regIsIDCard},attrs:{placeholder:"请输入身份证号"},on:{blur:function(r){e.blurIdCard(t.visitorId)},change:function(r){e.regID(t.visitorId)}},model:{value:t.visitorId,callback:function(r){e.$set(t,"visitorId",r)},expression:"item.visitorId"}}),r("span",{staticStyle:{position:"absolute",top:"22px",left:"0px",color:"#f56c6c"}},[e._v("*")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowIDCard,expression:"isShowIDCard"}],staticStyle:{color:"#F56C6C","text-align":"left",position:"absolute",top:"50px",left:"8px"}},[e._v("请输入身份证号")])],1),r("td",[r("el-input",{attrs:{placeholder:"请输入车牌号"},model:{value:t.carId,callback:function(r){e.$set(t,"carId",r)},expression:"item.carId"}})],1),r("td",[r("div",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.imgUrl,expression:"!item.imgUrl"}],attrs:{size:"mini",type:"primary"},on:{click:function(t){e.handlePhotoUpload(n)}}},[e._v("开始拍照")])],1),r("div",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl,expression:"item.imgUrl"}],attrs:{size:"mini",type:"primary"},on:{click:function(t){e.handlePhotoUpload(n)}}},[e._v("重新拍照")])],1)]),r("td",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl,expression:"item.imgUrl"}],attrs:{size:"mini",type:"text"},on:{click:function(t){e.handleLookImg(n)}}},[e._v("查看图片")])],1)])}),0)])]),r("div",{staticClass:"tempVisitInput_camera"},[r("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"1100px","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",[r("input",{attrs:{type:"hidden",value:"",id:"photoUrl"}}),r("iframe",{attrs:{width:"100%",height:"400",frameborder:"0",src:"http://10.19.8.22:8081/sanyvisitorcontrol/photo/photo.html",id:"myframe",name:"myframe"}})]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmCamera}},[e._v("确 定")])],1)])],1),r("el-dialog",{staticClass:"edit-form",attrs:{title:"图片信息",visible:e.dialogVisibleImg,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisibleImg=t}}},[r("div",{staticClass:"inputText",staticStyle:{display:"flex","justify-content":"center","align-items":"center",overflow:"hidden"}},[r("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.lookCurrentImgUrl,alt:""}})])]),r("div",{staticClass:"marginTop20",staticStyle:{"text-align":"center"}},[r("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)],1)},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",[e._v("序号")]),r("th",[e._v("拜访人姓名")]),r("th",[e._v("电话号码")]),r("th",[e._v("身份证号")]),r("th",[e._v("车牌号")]),r("th",[e._v("拍照")]),r("th",[e._v("查看图片")])])])}],s=(r("7f7f"),r("96cf"),r("3b8d")),a=r("0a0d"),o=r.n(a),l=(r("cadf"),r("551c"),r("097d"),r("47d5")),u=r("9a38"),c={name:"tempVisitInput",data:function(){var e=this;return{restaurantsArr:[],employerNameSelectShow:!1,isDriveCarOptions:[{label:"是",value:"1"},{label:"否",value:"0"}],pickerOptionsStart:{disabledDate:function(e){return e.getTime()<o()()-864e5}},pickerOptionsEnd:{disabledDate:function(t){return t.getTime()<o()()-864e5||t.getTime()<new Date(e.formInline.sanyBussVisitor.planBeginTime).getTime()-864e5}},regIsNull:!1,regIsIDCard:!1,regIsName:!1,isShowUserName:!1,isShowPhone:!1,isShowIDCard:!1,rules:{planBeginTime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],planEndTime:[{required:!0,message:"请选择结束时间",trigger:"blur"}]},formInline:{sanyBussVisitor:{planBeginTime:"",planEndTime:"",vistorNum:"",isCar:"0",carNum:"",reason:""},sanyBussVisitorDetailsList:[{visitorName:"",phone:"",visitorId:"",imgUrl:"",carId:""}],sanyBussVisitorCarList:[]},dialogVisible:!1,dialogVisibleImg:!1,currentUploadIndex:0,lookCurrentImgUrl:0}},mounted:function(){},methods:{getNamesByLikeData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(l["f"])(t);case 4:r=e.sent,r&&200===r.data.code&&(n=r.data.data,this.restaurantsArr=n,this.employerNameSelectShow=!0);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),querySearch:function(e){var t=this.formInline.sanyBussVisitor.employerName;this.getNamesByLikeData(t)},handleSelect:function(e){this.formInline.sanyBussVisitor.employerName=e.name,this.formInline.sanyBussVisitor.employerCode=e.userNo,this.employerNameSelectShow=!1},handleInputPersonNum:function(){var e=this.formInline.sanyBussVisitor.vistorNum;this.formInline.sanyBussVisitorDetailsList=[];for(var t=0;t<e;t++)this.formInline.sanyBussVisitorDetailsList.push({visitorName:"",phone:"",visitorId:"",imgUrl:"",carId:""})},handlePhotoUpload:function(e){this.dialogVisible=!0,this.currentUploadIndex=e,myframe.window.Webcam.attach("#my_camera")},handleConfirmCamera:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.dialogVisible=!1,t=myframe.window.getTakePhotoUrl(),!t){e.next=7;break}return e.next=5,Object(l["d"])(t);case 5:r=e.sent,r&&200===r.data.code?this.formInline.sanyBussVisitorDetailsList[this.currentUploadIndex].imgUrl=r.data.data:this.$message({type:"error",message:"图片上传服务器失败！"});case 7:myframe.window.Webcam.reset();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleLookImg:function(e){this.dialogVisibleImg=!0,this.currentUploadIndex=e,this.lookCurrentImgUrl=this.formInline.sanyBussVisitorDetailsList[this.currentUploadIndex].imgUrl},handleInputCarNum:function(){var e=this.formInline.sanyBussVisitor,t=e.carNum,r=e.vistorNum;if(t>r)return this.formInline.sanyBussVisitor.carNum=this.formInline.sanyBussVisitor.vistorNum-1,void this.$message({type:"error",message:"输入车辆必须小于人员数量"})},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e(),Webcam.reset()}).catch(function(e){})},handleSave:function(){var e=this;this.$refs.tempVisitInputID.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(r){var n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:n=e.formInline.sanyBussVisitorDetailsList,i=0;case 4:if(!(i<n.length)){t.next=11;break}if(""===n[i].visitorName?(e.regIsName=!0,e.isShowUserName=!0):""===n[i].phone?(e.regIsNull=!0,e.isShowPhone=!0):""===n[i].visitorId&&(e.regIsIDCard=!0,e.isShowIDCard=!0),""!==n[i].visitorName&&""!==n[i].visitorId&&""!==n[i].phone){t.next=8;break}return t.abrupt("return");case 8:i++,t.next=4;break;case 11:e.formInline.source=2,e.addApplyRequestData(e.formInline);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())},addApplyRequestData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["a"])(t);case 2:if(r=e.sent,r&&200===r.data.code){e.next=6;break}return this.$message({type:"error",message:r.data.msg}),e.abrupt("return");case 6:this.$message({type:"success",message:r.data.data}),this.formInline.sanyBussVisitor={planBeginTime:"",planEndTime:"",vistorNum:"",isCar:"",carNum:"",reason:""},this.formInline.sanyBussVisitorDetailsList=[],this.formInline.sanyBussVisitorCarList=[];case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),regTel:function(e){Object(u["b"])(e,this),console.log("tel:",e),this.regIsNull=""===e},regID:function(e){Object(u["a"])(e,this),this.regIsIDCard=""===e},inputChangeName:function(e){this.regIsName=""===e},blurUserName:function(e){this.regIsName=""===e,this.isShowUserName=""===e},blurPhone:function(e){this.regIsNull=""===e,this.isShowPhone=""===e},blurIdCard:function(e){this.regIsIDCard=""===e,this.isShowIDCard=""===e}}},m=c,p=(r("5c41"),r("2877")),d=Object(p["a"])(m,n,i,!1,null,"11723a24",null);d.options.__file="tempVisitInput.vue";t["default"]=d.exports},e829:function(e,t,r){r("2f37"),e.exports=r("584a").Date.now}}]);
//# sourceMappingURL=chunk-4794c912.325bed7c.js.map